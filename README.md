# ad-users-groups-migrate-commands-generator
Program to generate all the necessary Active Directory PowerShell Module commands to migrate Users, Groups and Organizational Units between disconnected Domain Controllers.  The program creates the commands by parsing the reports generated by Get-ADUser and Get-ADGroup commands on the source domain.

The utlity will generate these commands in order:

First, New-ADOrganizationalUnit to make sure every user or group has its appropriate container.

Then, New-ADUser followed by Set-ADUser to create and then assign the old domain email address to the new user.  In case email delivery will be migrated to the new organization as well.

Next, New-ADGroup followed by Add-ADGroupMember to create and add users to the same groups they used to be in the old organization.  The type and scope of the groups are maintained during migration.

Some users do not have all their properties set, so the program keeps track of the properties without values and only includes the properties that have values in the New-ADUser user commands it generates.

The Reports.ps1 file contains the commands needed to produce the reports in the format the program is expecting.  The filter in the commands can be varied to accommodate different migration requirements.
